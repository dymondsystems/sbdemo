<!DOCTYPE html>
<html lang="en">
<head>
    <style>
        /* Add this CSS for the bot's image and message container */
        .bot-message-container {
            display: flex;
            align-items: flex-start; /* Align items to the top */
            margin-bottom: 10px; /* Space between bot messages */
        }

        /* Style for the bot's image */
        .bot-image {
            width: 40px; /* Adjust the size of the image */
            height: 40px;
            border-radius: 50%; /* Optional: Makes the image round */
            margin-right: 10px; /* Space between the image and the message */
            flex-shrink: 0; /* Prevent the image from shrinking */
        }

        /* Style for the bot's message */
        .message.to {
            background: #efefef; /* Background color for the message bubble */
            color: #6f6f6f; /* Text color */
            padding: 10px 15px; /* Padding inside the message bubble */
            border-radius: 20px; /* Rounded corners for the message bubble */
            max-width: 70%; /* Limit the width of the message bubble */
            word-wrap: break-word; /* Ensure long words break */
            position: relative;
        }

        /* Optional: Add a triangle to the message bubble */
        .message.to::before {
            content: '';
            position: absolute;
            left: -10px; /* Position the triangle to the left of the message */
            top: 10px;
            width: 0;
            height: 0;
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
            border-right: 10px solid #efefef; /* Match the background color of the message */
        }

        /* Your existing CSS */
        div#chat div.options div.option {
            padding: 0px 0px !important;
            border: 10px solid rgba(6,153,184,0.3);
            display: block !important;
            margin: 10px;
            background: #fff;
            cursor: pointer;
            border-radius: 2px !important;
            font-size: 20px !important;
        }

        form.convFormDynamic {
            width: calc(100% - 33px);
            margin: 10px auto 15px;
            padding: 0 !important;
            position: relative;
        }

        form.convFormDynamic textarea.userInputDynamic,
        form.convFormDynamic input.userInputDynamic {
            border: none;
            padding: 7px 10px;
            outline: none;
            font-size: 0.905rem;
            float: left;
            width: calc(100% - 70px);
            line-height: 1.3em;
            min-height: 1.7em;
            max-height: 10rem;
            display: block;
            max-width: 88%;
            margin-right: 2.5%;
        }

        div#chat.conv-form-wrapper div#messages {
            max-height: 71vh;
            height: auto !important;
            overflow-y: scroll;
        }

        div#chat.conv-form-wrapper div#messages:after {
            content: '';
            display: table;
            clear: both;
        }

        div#chat.conv-form-wrapper {
            position: relative;
        }

        div#chat.conv-form-wrapper div.wrapper-messages {
            position: relative;
            height: 577px;
            max-height: 71vh;
            overflow-y: scroll;
        }

        div#chat:before {
            content: '';
            position: absolute;
            width: 100%;
            display: block;
            height: 30px;
            top: 0;
            left: 0;
            z-index: 2;
        }

        @media (max-width: 767px) {
            div#chat.conv-form-wrapper div.wrapper-messages,
            div#chat.conv-form-wrapper div#messages {
                max-height: 71vh;
            }
        }

        div#chat div.wrapper-messages::-webkit-scrollbar,
        div#feed ul::-webkit-scrollbar,
        div#chat div.options::-webkit-scrollbar {
            width: 0px;
            height: 0px;
            background: transparent;
        }

        input[type="text"].userInputDynamic.error {
            color: #ac0000 !important;
        }

        input[type="text"].userInputDynamic {
            border-radius: 3px;
            margin: 7px 10px;
        }

        textarea.userInputDynamic.error {
            color: #ac0000 !important;
        }

        textarea.userInputDynamic {
            border-radius: 3px;
            margin: 7px 10px;
        }

        div#chat.conv-form-wrapper div#messages {
            transition: bottom 0.15s, padding-bottom 0.15s;
            position: absolute;
            bottom: 0;
            height: auto !important;
            width: 100%;
            padding-bottom: 20px;
        }

        div#chat div.options {
            word-wrap: normal;
            white-space: nowrap;
            overflow-x: scroll;
            position: absolute;
            bottom: 100%;
            width: 100%;
            transform: translateY(-5px);
        }

        div#chat div.options:after {
            content: '';
            display: table;
            clear: both;
        }

        div#chat div.options div.option {
            padding: 7px 12px;
            border: 1px solid rgba(6,153,184,0.3);
            display: inline-block;
            margin: 5px;
            background: #fff;
            color: #06c5a6;
            cursor: pointer;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        div#chat.conv-form-wrapper div.message {
            animation: slideTop 0.15s ease;
        }

        div#chat.conv-form-wrapper div.message:after {
            content: '';
            display: table;
            clear: both;
        }

        div#chat.conv-form-wrapper div.message.ready {
            animation: bounceIn 0.2s ease;
            transform-origin: 0 0 0;
        }

        div#chat.conv-form-wrapper div#messages div.message {
            border-radius: 20px;
            padding: 12px 22px;
            font-size: 0.905rem;
            color: #333;
            display: inline-block;
            padding: 10px 15px 8px;
            border-radius: 20px;
            margin-bottom: 5px;
            float: right;
            clear: both;
            max-width: 65%;
            word-wrap: break-word;
        }

        div#chat.conv-form-wrapper div#messages div.message.to {
            background: #efefef;
            color: #6f6f6f;
            float: left;
            border-top-left-radius: 0;
        }

        div#chat.conv-form-wrapper div#messages div.message.from {
            background: #06b79a;
            color: #fff;
            border-top-right-radius: 0;
        }

        .message.to+.message.from,
        .message.from+.message.to {
            margin-top: 15px;
        }

        @keyframes slideTop {
            0% {
                margin-bottom: -25px;
            }
            100% {
                margin-bottom: 0;
            }
        }

        @keyframes bounceIn {
            0% {
                transform: scale(0.75, 0.75);
            }
            100% {
                transform: scale(1.0, 1.0);
            }
        }

        div#chat div.options div.option:hover {
            background: #eeeeee;
        }

        div#chat div.options div.option.selected {
            background: #06b79a;
            color: #fff;
        }

        div#chat div.options div.option.selected:hover {
            background: #069c7f;
        }

        form.convFormDynamic button.submit {
            padding: 3px;
            border: none;
            float: left;
            margin: 5px;
            color: #06c5a6;
            cursor: pointer;
            border-radius: 8px;
            font-size: 1.1rem;
            width: 36px;
            height: 35px;
            margin-top: 4px;
            background: #fff;
            outline: none !important;
        }

        form.convFormDynamic button.submit:hover {
            background: #06b79a;
            color: #fff;
        }

        button.submit.glow {
        }

        .no-border {
            border: none !important;
        }

        .dragscroll {
            cursor: grab;
        }

        div#chat div#messages::-webkit-scrollbar,
        div#feed ul::-webkit-scrollbar {
            width: 0px;
            background: transparent;
        }

        span.clear {
            display: block;
            clear: both;
        }

        .spinLoader,
        .spinLoader:before,
        .spinLoader:after {
            background: #06c5a6 !important;
            -webkit-animation: spinLoaderChat 1s infinite ease-in-out;
            animation: spinLoaderChat 1s infinite ease-in-out;
            width: 1em;
            height: 4em;
        }

        .spinLoader {
            color: #06c5a6 !important;
            text-indent: -9999em;
            margin: 50% auto;
            position: relative;
            font-size: 11px;
            -webkit-transform: translateZ(0);
            -ms-transform: translateZ(0);
            transform: translateZ(0);
            -webkit-animation-delay: -0.16s;
            animation-delay: -0.16s;
        }

        .spinLoader:before,
        .spinLoader:after {
            position: absolute;
            top: 0;
            content: '';
        }

        .spinLoader:before {
            left: -1.5em;
            -webkit-animation-delay: -0.32s;
            animation-delay: -0.32s;
        }

        .spinLoader:after {
            left: 1.5em;
        }

        @-webkit-keyframes spinLoaderChat {
            0%,
            80%,
            100% {
                box-shadow: 0 0;
                height: 4em;
            }
            40% {
                box-shadow: 0 -2em;
                height: 5em;
            }
        }

        @keyframes spinLoaderChat {
            0%,
            80%,
            100% {
                box-shadow: 0 0;
                height: 4em;
            }
            40% {
                box-shadow: 0 -2em;
                height: 5em;
            }
          
          
          /* Typing loader animation */
.typing_loader {
    width: 6px;
    height: 6px;
  color: black;
    border-radius: 50%;
    background-color: #06b79a; /* Match the bot's message color */
    position: relative;
    animation: typingLoader 1s infinite ease-in-out;
}

.typing_loader::before,
.typing_loader::after {
    content: '';
    position: absolute;
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background-color: #06b79a; /* Match the bot's message color */
    animation: typingLoader 1s infinite ease-in-out;
}

.typing_loader::before {
    left: -10px;
    animation-delay: -0.2s;
}

.typing_loader::after {
    left: 10px;
    animation-delay: 0.2s;
}

@keyframes typingLoader {
    0%, 80%, 100% {
        transform: scale(0);
    }
    40% {
        transform: scale(1);
    }
}
        }
    </style>
    <title>convForm - example</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://eduardotkoller.github.io/convForm/dist/jquery.convform.cs">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://eduardotkoller.github.io/convForm/demo.css">
</head>
<body>
    <section id="demo">
        <div class="vertical-align">
            <div class="container">
                <div class="row">
                    <div class="col-sm-6 col-sm-offset-3 col-xs-offset-0">
                        <div class="card no-border">
                            <div id="chat" class="conv-form-wrapper">
                                <form action="" method="GET" class="hidden">
                                    <select name="programmer" data-callback="storeState" data-conv-question="Good day! would you like to create a facebook post about your recent projects?">
                                    
    
    
    
   
   

                                        <option value="yes">Yes </option>
                                        <option value="no">Something else</option>
                                      

                                      
                                    </select>
                                    <div data-conv-fork="programmer">
                                        <div data-conv-case="yes">
                                            <select name="programmer" data-callback="storeState" data-conv-question="Awesome! 
                                                Which project would you like to post about?">
                                                <option value="yes2">beta launch</option>
                                              <option value="no">Create demo video</option>
                                              <option value="no">Make soup</option>
                                                <option value="no">Other</option>
                                              
                                            </select>
                                        </div>
                                      
                                      <div data-conv-fork="programmer">
                                        <div data-conv-case="yes2">
                                            <select name="programmer" data-callback="storeState" data-conv-question="Got it! I can create a post about stackboard's beta launch and use your saved images and notes. Would you like me to proceed?">
                                                <option value="yes3">Go for it!</option>
                                                <option value="no">Other</option>
                                            </select>
                                        </div>
                                      </div>
                                        
                                        
                                        <div data-conv-fork="programmer">
                                        <div data-conv-case="yes3">
                                            <select name="programmer" data-callback="storeState" data-conv-question="Here is your facebook content:
                                                                                    
                                                        
    <div class=&quot;card&quot; style=&quot;width:200px&quot;>
    <div class=&quot;card-body&quot;>
           <img class=&quot;card-img-bottom&quot; src=&quot;https://images.unsplash.com/photo-1683721003111-070bcc053d8b?fm=jpg&q=60&w=3000&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&quot; alt=&quot;Card image&quot; style=&quot;width:100%&quot;>                                                                                                            
      <h4 class=&quot;card-title&quot;>Get early access!</h4>
      <p class=&quot;card-text&quot;>stackboard is going into public beta soon...</p>
      <a href=&quot;#&quot;>View more</a>
                                                                                                                     </div>
                                                                                                                     </div>
                                                                                                                     <br>
  


   Here are some posting options:
                                                                                                                     <br>
                                                                                                                     Post now
  <br>                                                                                                                  Schedule post and post at optimal time ">
                                                <option value="yes2">Post now</option>
                                                <option value="no">Schedule post</option>
                                              <option value="no">Try again</option>
                                            </select>
                                        </div>
                                        
                                        
                                        
                                        
                                        
                                      </div>
                                    </div>
                                </form>
                            </div>
                          <form>
    <div class="form-group" style="margin-bottom: 100px;">
      
      <textarea class="form-control" rows="5" id="comment"></textarea>
      <span class="input-group-addon" style="width: 100px; height: 30px; float: right;"><i class="glyphicon glyphicon-plus"></i></span>
    </div>
  </form>
                          
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script type="text/javascript" src="https://eduardotkoller.github.io/convForm/jquery-1.12.3.min.js"></script>
    <script type="text/javascript" src="https://eduardotkoller.github.io/convForm/dist/autosize.min.js"></script>
    <script>
        function dymond() {
            window.open("http://dymondsystems.com");
        }

        function google() {
            window.open("https://google.com");
        }

        function bing() {
            window.open("https://bing.com");
        }

        var rollbackTo = false;
        var originalState = false;

        function storeState(stateWrapper) {
            rollbackTo = stateWrapper.current;
            console.log("storeState called: ", rollbackTo);
        }

        function rollback(stateWrapper) {
            console.log("rollback called: ", rollbackTo, originalState);
            console.log("answers at the time of user input: ", stateWrapper.answers);
            if (rollbackTo != false) {
                if (originalState == false) {
                    originalState = stateWrapper.current.next;
                    console.log('stored original state');
                }
                stateWrapper.current.next = rollbackTo;
                console.log('changed current.next to rollbackTo');
            }
        }

        function restore(stateWrapper) {
            if (originalState != false) {
                stateWrapper.current.next = originalState;
                console.log('changed current.next to originalState');
            }
        }

        function SingleConvState(input) {
            this.input = input;
            this.next = false;
            return this;
        }

        SingleConvState.prototype.hasNext = function () {
            return this.next;
        };

        function ConvState(wrapper, SingleConvState, form, params) {
            this.form = form;
            this.wrapper = wrapper;
            this.current = SingleConvState;
            this.answers = {};
            this.parameters = params;
            this.scrollDown = function () {
                $(this.wrapper).find('#messages').stop().animate({ scrollTop: $(this.wrapper).find('#messages')[0].scrollHeight }, 600);
            }.bind(this);
        }

        ConvState.prototype.next = function () {
            if (this.current.input.hasOwnProperty('callback')) {
                window[this.current.input.callback](this);
            }
            if (this.current.hasNext()) {
                this.current = this.current.next;
                if (this.current.input.hasOwnProperty('fork') && this.current.input.hasOwnProperty('case')) {
                    if (this.answers.hasOwnProperty(this.current.input.fork) && this.answers[this.current.input.fork].value != this.current.input.case) {
                        return this.next();
                    }
                    if (!this.answers.hasOwnProperty(this.current.input.fork)) {
                        return this.next();
                    }
                }
                return true;
            } else {
                return false;
            }
        };

        ConvState.prototype.printQuestion = function () {
            var questions = this.current.input.questions;
            var question = questions[Math.floor(Math.random() * questions.length)]; //get a random question from questions array
            var ansWithin = question.match(/\{(.*?)\}(\:(\d)*)?/g); // searches for string replacements for answers and replaces them with previous aswers (warning: not checking if answer exists)
            for (var key in ansWithin) {
                if (ansWithin.hasOwnProperty(key)) {
                    var ansKey = ansWithin[key].replace(/\{|\}/g, "");
                    var ansFinalKey = ansKey;
                    var index = false;
                    if (ansKey.indexOf(':') != -1) {
                        ansFinalKey = ansFinalKey.split(':')[0];
                        index = ansKey.split(':')[1];
                    }
                    if (index !== false) {
                        var replacement = this.answers[ansFinalKey].text.split(' ');
                        if (replacement.length >= index) {
                            question = question.replace(ansWithin[key], replacement[index]);
                        } else {
                            question = question.replace(ansWithin[key], this.answers[ansFinalKey].text);
                        }
                    } else {
                        question = question.replace(ansWithin[key], this.answers[ansFinalKey].text);
                    }
                }
            }
            // Create a container for the bot's image and message
            var messageContainer = $('<div class="bot-message-container"></div>');
            var botImage = $('<img src="https://www.shareicon.net/download/2016/11/14/851902_th.svg" class="bot-image">');
            var messageObj = $('<div class="message to typing"><div class="typing_loader"></div></div>');

            // Append the image first, then the message
            messageContainer.append(botImage);
            messageContainer.append(messageObj);

            setTimeout(function () {
                $(this.wrapper).find('#messages').append(messageContainer);
                this.scrollDown();
            }.bind(this), 100);
            setTimeout(function () {
                messageObj.find('.typing_loader').replaceWith('<div class="message-text">' + question + '</div>');
                messageObj.removeClass('typing').addClass('ready');
                if (this.current.input.type == "select") {
                    this.printAnswers(this.current.input.answers, this.current.input.multiple);
                }
                this.scrollDown();
                if (this.current.input.hasOwnProperty('noAnswer')) {
                    if (this.next()) {
                        setTimeout(function () {
                            this.printQuestion();
                        }.bind(this), 200);
                    } else {
                        this.parameters.eventList.onSubmitForm(this);
                    }
                }
                $(this.wrapper).find(this.parameters.inputIdHashTagName).focus();
            }.bind(this), 1000);
        };

        ConvState.prototype.printAnswers = function (answers, multiple) {
            this.wrapper.find('div.options div.option').remove();
            if (multiple) {
                for (var i in answers) {
                    if (answers.hasOwnProperty(i)) {
                        var option = $('<div class="option">' + answers[i].text + '</div>')
                            .data("answer", answers[i])
                            .click(function (event) {
                                var indexOf = this.current.input.selected.indexOf($(event.target).data("answer").value);
                                if (indexOf == -1) {
                                    this.current.input.selected.push($(event.target).data("answer").value);
                                    $(event.target).addClass('selected');
                                } else {
                                    this.current.input.selected.splice(indexOf, 1);
                                    $(event.target).removeClass('selected');
                                }
                                this.wrapper.find(this.parameters.inputIdHashTagName).removeClass('error');
                                this.wrapper.find(this.parameters.inputIdHashTagName).val('');
                                if (this.current.input.selected.length > 0) {
                                    this.wrapper.find('button.submit').addClass('glow');
                                } else {
                                    this.wrapper.find('button.submit').removeClass('glow');
                                }
                            }.bind(this));
                        this.wrapper.find('div.options').append(option);
                        $(window).trigger('dragreset');
                    }
                }
            } else {
                for (var i in answers) {
                    if (answers.hasOwnProperty(i)) {
                        var option = $('<div class="option">' + answers[i].text + '</div>')
                            .data("answer", answers[i])
                            .click(function (event) {
                                this.current.input.selected = $(event.target).data("answer").value;
                                this.wrapper.find(this.parameters.inputIdHashTagName).removeClass('error');
                                this.wrapper.find(this.parameters.inputIdHashTagName).val('');
                                this.answerWith($(event.target).data("answer").text, $(event.target).data("answer"));
                                this.wrapper.find('div.options div.option').remove();
                            }.bind(this));
                        this.wrapper.find('div.options').append(option);
                        $(window).trigger('dragreset');
                    }
                }
            }
            var diff = $(this.wrapper).find('div.options').height();
            $(this.wrapper).find('#messages').css({ paddingBottom: diff });
        };

        ConvState.prototype.answerWith = function (answerText, answerObject) {
            if (this.current.input.hasOwnProperty('name')) {
                if (typeof answerObject == 'string') {
                    if (this.current.input.type == 'tel')
                        answerObject = answerObject.replace(/\s|\(|\)|-/g, "");
                    this.answers[this.current.input.name] = { text: answerText, value: answerObject };
                } else {
                    this.answers[this.current.input.name] = answerObject;
                }
                if (this.current.input.type == 'select' && !this.current.input.multiple) {
                    $(this.current.input.element).val(answerObject.value).change();
                } else {
                    $(this.current.input.element).val(answerObject).change();
                }
            }
            if (this.current.input.type == 'password')
                answerText = answerText.replace(/./g, '*');
            var message = $('<div class="message from">' + answerText + '</div>');

            $(this.wrapper).find("div.options div.option").remove();

            var diff = $(this.wrapper).find('div.options').height();
            $(this.wrapper).find('#messages').css({ paddingBottom: diff });
            $(this.wrapper).find(this.parameters.inputIdHashTagName).focus();
            if (answerObject.hasOwnProperty('callback')) {
                window[answerObject.callback](this);
            }
            setTimeout(function () {
                $(this.wrapper).find("#messages").append(message);
                this.scrollDown();
            }.bind(this), 300);

            $(this.form).append(this.current.input.element);
            if (this.next()) {
                setTimeout(function () {
                    this.printQuestion();
                }.bind(this), 300);
            } else {
                this.parameters.eventList.onSubmitForm(this);
            }
        };

        (function ($) {
            $.fn.convform = function (options) {
                var wrapper = this;
                var parameters = $.extend(true, {}, {
                    placeHolder: 'Type Here',
                    typeInputUi: 'textarea',
                    timeOutFirstQuestion: 1200,
                    buttonClassStyle: 'icon2-arrow',
                    eventList: {
                        onSubmitForm: function (convState) {
                            console.log('completed');
                            convState.form.submit();
                            return true;
                        }
                    },
                    formIdName: 'convForm',
                    inputIdName: 'userInput',
                    loadSpinnerVisible: '',
                    buttonText: ''
                }, options);

                var inputs = $(this).find('input, select, textarea').map(function () {
                    var input = {};
                    if ($(this).attr('name'))
                        input['name'] = $(this).attr('name');
                    if ($(this).attr('data-no-answer'))
                        input['noAnswer'] = true;
                    if ($(this).attr('required'))
                        input['required'] = true;
                    if ($(this).attr('type'))
                        input['type'] = $(this).attr('type');
                    input['questions'] = $(this).attr('data-conv-question').split("|");
                    if ($(this).attr('data-pattern'))
                        input['pattern'] = $(this).attr('data-pattern');
                    if ($(this).attr('data-callback'))
                        input['callback'] = $(this).attr('data-callback');
                    if ($(this).is('select')) {
                        input['type'] = 'select';
                        input['answers'] = $(this).find('option').map(function () {
                            var answer = {};
                            answer['text'] = $(this).text();
                            answer['value'] = $(this).val();
                            if ($(this).attr('data-callback'))
                                answer['callback'] = $(this).attr('data-callback');
                            return answer;
                        }).get();
                        if ($(this).prop('multiple')) {
                            input['multiple'] = true;
                            input['selected'] = [];
                        } else {
                            input['multiple'] = false;
                            input['selected'] = "";
                        }
                    }
                    if ($(this).parent('div[data-conv-case]').length) {
                        input['case'] = $(this).parent('div[data-conv-case]').attr('data-conv-case');
                        input['fork'] = $(this).parent('div[data-conv-case]').parent('div[data-conv-fork]').attr('data-conv-fork');
                    }
                    input['element'] = this;
                    $(this).detach();
                    return input;
                }).get();

                if (inputs.length) {
                    var form = $(wrapper).find('form').hide();

                    var inputForm;
                    parameters.inputIdHashTagName = '#' + parameters.inputIdName;

                    switch (parameters.typeInputUi) {
                        case 'input':
                            inputForm = $('<form id="' + parameters.formIdName + '" class="convFormDynamic"><div class="options dragscroll"></div><input id="' + parameters.inputIdName + '" type="text" placeholder="' + parameters.placeHolder + '" class="userInputDynamic"></><button type="submit" class="submit">' + parameters.buttonText + '</button><span class="clear"></span></form>');
                            break;
                        case 'textarea':
                            inputForm = $('<form id="' + parameters.formIdName + '" class="convFormDynamic"><div class="options dragscroll"></div><textare id="' + parameters.inputIdName + '" rows="1" placeholder="' + parameters.placeHolder + '" class="userInputDynamic"></textarea><button type="submit" class="submit">' + parameters.buttonText + '</button><span class="clear"></span></form>');
                            break;
                        default:
                            console.log('typeInputUi must be input or textarea');
                            return false;
                    }

                    $(wrapper).append('<div class="wrapper-messages"><div class="spinLoader ' + parameters.loadSpinnerVisible + ' "></div><div id="messages"></div></div>');
                    $(wrapper).append(inputForm);

                    var singleState = new SingleConvState(inputs[0]);
                    var state = new ConvState(wrapper, singleState, form, parameters);
                    for (var i in inputs) {
                        if (i != 0 && inputs.hasOwnProperty(i)) {
                            singleState.next = new SingleConvState(inputs[i]);
                            singleState = singleState.next;
                        }
                    }

                    setTimeout(function () {
                        $.when($('div.spinLoader').addClass('hidden')).done(function () {
                            state.printQuestion();
                        });
                    }, parameters.timeOutFirstQuestion);

                    $(inputForm).find(parameters.inputIdHashTagName).keypress(function (e) {
                        if (e.which == 13) {
                            var input = $(this).val();
                            e.preventDefault();
                            if (state.current.input.type == "select" && !state.current.input.multiple) {
                                if (state.current.input.required) {
                                    state.wrapper.find('#userInputBot').addClass('error');
                                } else {
                                    var results = state.current.input.answers.filter(function (el) {
                                        return el.text.toLowerCase().indexOf(input.toLowerCase()) != -1;
                                    });
                                    if (results.length) {
                                        state.current.input.selected = results[0];
                                        $(this).parent('form').submit();
                                    } else {
                                        state.wrapper.find(parameters.inputIdHashTagName).addClass('error');
                                    }
                                }
                            } else if (state.current.input.type == "select" && state.current.input.multiple) {
                                if (input.trim() != "") {
                                    var results = state.current.input.answers.filter(function (el) {
                                        return el.text.toLowerCase().indexOf(input.toLowerCase()) != -1;
                                    });
                                    if (results.length) {
                                        if (state.current.input.selected.indexOf(results[0].value) == -1) {
                                            state.current.input.selected.push(results[0].value);
                                            state.wrapper.find(parameters.inputIdHashTagName).val("");
                                        } else {
                                            state.wrapper.find(parameters.inputIdHashTagName).val("");
                                        }
                                    } else {
                                        state.wrapper.find(parameters.inputIdHashTagName).addClass('error');
                                    }
                                } else {
                                    if (state.current.input.selected.length) {
                                        $(this).parent('form').submit();
                                    }
                                }
                            } else {
                                if (input.trim() != '' && !state.wrapper.find(parameters.inputIdHashTagName).hasClass("error")) {
                                    $(this).parent('form').submit();
                                } else {
                                    $(state.wrapper).find(parameters.inputIdHashTagName).focus();
                                }
                            }
                        }
                        autosize.update($(state.wrapper).find(parameters.inputIdHashTagName));
                    }).on('input', function (e) {
                        if (state.current.input.type == "select") {
                            var input = $(this).val();
                            var results = state.current.input.answers.filter(function (el) {
                                return el.text.toLowerCase().indexOf(input.toLowerCase()) != -1;
                            });
                            if (results.length) {
                                state.wrapper.find(parameters.inputIdHashTagName).removeClass('error');
                                state.printAnswers(results, state.current.input.multiple);
                            } else {
                                state.wrapper.find(parameters.inputIdHashTagName).addClass('error');
                            }
                        } else if (state.current.input.hasOwnProperty('pattern')) {
                            var reg = new RegExp(state.current.input.pattern, 'i');
                            if (reg.test($(this).val())) {
                                state.wrapper.find(parameters.inputIdHashTagName).removeClass('error');
                            } else {
                                state.wrapper.find(parameters.inputIdHashTagName).addClass('error');
                            }
                        }
                    });

                    $(inputForm).find('button.submit').click(function (e) {
                        var input = $(state.wrapper).find(parameters.inputIdHashTagName).val();
                        e.preventDefault();
                        if (state.current.input.type == "select" && !state.current.input.multiple) {
                            if (state.current.input.required) {
                                return false;
                            } else {
                                if (input == parameters.placeHolder) input = '';
                                var results = state.current.input.answers.filter(function (el) {
                                    return el.text.toLowerCase().indexOf(input.toLowerCase()) != -1;
                                });
                                if (results.length) {
                                    state.current.input.selected = results[0];
                                    $(this).parent('form').submit();
                                } else {
                                    state.wrapper.find(parameters.inputIdHashTagName).addClass('error');
                                }
                            }
                        } else if (state.current.input.type == "select" && state.current.input.multiple) {
                            if (state.current.input.required) {
                                return false;
                            } else {
                                if (input.trim() != "" && input != parameters.placeHolder) {
                                    var results = state.current.input.answers.filter(function (el) {
                                        return el.text.toLowerCase().indexOf(input.toLowerCase()) != -1;
                                    });
                                    if (results.length) {
                                        if (state.current.input.selected.indexOf(results[0].value) == -1) {
                                            state.current.input.selected.push(results[0].value);
                                            state.wrapper.find(parameters.inputIdHashTagName).val("");
                                        } else {
                                            state.wrapper.find(parameters.inputIdHashTagName).val("");
                                        }
                                    } else {
                                        state.wrapper.find(parameters.inputIdHashTagName).addClass('error');
                                    }
                                } else {
                                    if (state.current.input.selected.length) {
                                        $(this).removeClass('glow');
                                        $(this).parent('form').submit();
                                    }
                                }
                            }
                        } else {
                            if (input.trim() != '' && !state.wrapper.find(parameters.inputIdHashTagName).hasClass("error")) {
                                $(this).parent('form').submit();
                            } else {
                                $(state.wrapper).find(parameters.inputIdHashTagName).focus();
                            }
                        }
                        autosize.update($(state.wrapper).find(parameters.inputIdHashTagName));
                    });

                    $(inputForm).submit(function (e) {
                        e.preventDefault();
                        var answer = $(this).find(parameters.inputIdHashTagName).val();
                        $(this).find(parameters.inputIdHashTagName).val("");
                        if (state.current.input.type == 'select') {
                            if (!state.current.input.multiple) {
                                state.answerWith(state.current.input.selected.text, state.current.input.selected);
                            } else {
                                state.answerWith(state.current.input.selected.join(', '), state.current.input.selected);
                            }
                        } else {
                            state.answerWith(answer, answer);
                        }
                    });

                    if (typeof autosize == 'function') {
                        $textarea = $(state.wrapper).find(parameters.inputIdHashTagName);
                        autosize($textarea);
                    }

                    return state;
                } else {
                    return false;
                }
            }
        })(jQuery);

        $(function () {
            var convForm = $('.conv-form-wrapper').convform();
            console.log(convForm);
        });
    </script>
</body>
</html>
